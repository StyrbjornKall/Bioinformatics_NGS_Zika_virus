---
title: "Result visualization"
#output: html_notebook
---
This notebook is used for visualizing the results from V-phaser2 and the Shannon entropies that are generated by using the project pipeline in script project_script.Rmd. 

# Loading data
```{r}
path_to_shannon_files = "~student12/project/results/shannon_entropy/"

library(tidyverse)

# List the data
file_list = list.files(path_to_shannon_files, pattern = "shannon_WT" ,full.names = TRUE)

column_names = c()
shannon_entropies = data.frame()

# Load the data in the folder
for (file in file_list){
  
  column_names = cbind(column_names, tools::file_path_sans_ext(basename(file)))
  shannon_entropies = rbind(shannon_entropies, t(read.table(file)))
  
}

# Needing to transpose data and rename columns
shannon_entropies = as.data.frame(t(as.matrix(shannon_entropies)))
colnames(shannon_entropies) = column_names

```

# Shannon Entropy
## Mean Shannon Entropy with standard error of the mean
```{r}
# Calculate standard error of the mean
standard_error = function(x) sd(x) / sqrt(length(x))

# Calculate mean entropy and standard error of the mean
mean_entropies = sapply(shannon_entropies, mean)
se = sapply(shannon_entropies, standard_error)
x = 1:6
```

```{r}
# plot the means and se
plot(x, mean_entropies,
    ylim=range(c(mean_entropies-se, mean_entropies+se)),
    pch=19, xlab="Passage", ylab="Mean Shannon entropy +/- SD",
    main="Mean entropy in WT ZIKV passage 0-5")
arrows(x, mean_entropies-se, x, mean_entropies+se, length=0.05, angle=90, code=3)

```


## Mean Shannon Entropy and coverage


# SNV
## Common SNVs across all passages
##they made it in excel but I hope there is a way to do so in R 






