% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
  \usepackage{amssymb}
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Result visualization},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Result visualization}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\hypertarget{instructions}{%
\subsection{Instructions :}\label{instructions}}

This notebook presents all the codes used to analyze and plot the data
obtained previously. The files used have been previously moved into the
folder results.

This script is divided into two sections, and each section correspond to
a figure of the repport :

\emph{Shannon Entropy : +Mean Shannon Entropy per passage per strain
(figure 2) +Mean Shannon Entropy and Mean Coverage (figure 3) }Variants
detection : +SNVs frequencies per passage per strain (figure 4) +SNVs
mapping across the genome (figure 6) +Mean Coverage and Total ammount of
SNVs (figure 5)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# All the libraries required :}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.0.5     v dplyr   1.0.3
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggrepel)}
\FunctionTok{library}\NormalTok{(ggprism)}
\end{Highlighting}
\end{Shaded}

\#\#SHANNON ENTROPY \#\#\#\#Mean Shannon Entropy per passage per strain

Description of the variables used :

\emph{\textbf{shannon\_entropies} : a data frame gathering for each
passage of each strain (column) the calculated shannon entropy for each
position in the genome (rows) }\textbf{mean\_entropies} : list of the
mean entropy for each passage/strain \emph{\textbf{se} : list of the
standard errors }\textbf{plot\_WT} : a data frame that associates the
mean entropy and the standard error for each passage of the WT strain
*\textbf{plot\_10D} : a data frame that associates the mean entropy and
the standard error for each passage of the 10D strain

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# List the data}
\NormalTok{path\_to\_shannon\_files }\OtherTok{=} \StringTok{"\textasciitilde{}student12/project/results/shannon\_entropy/"}
\NormalTok{file\_list }\OtherTok{=} \FunctionTok{list.files}\NormalTok{(path\_to\_shannon\_files, }\AttributeTok{pattern =} \StringTok{"shannon\_"}\NormalTok{ ,}\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Load the data in the data frame}
\NormalTok{column\_names }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\NormalTok{shannon\_entropies }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (file }\ControlFlowTok{in}\NormalTok{ file\_list)\{}
\NormalTok{  column\_names }\OtherTok{=} \FunctionTok{cbind}\NormalTok{(column\_names, tools}\SpecialCharTok{::}\FunctionTok{file\_path\_sans\_ext}\NormalTok{(}\FunctionTok{basename}\NormalTok{(file)))}
\NormalTok{  shannon\_entropies }\OtherTok{=} \FunctionTok{rbind}\NormalTok{(shannon\_entropies, }\FunctionTok{t}\NormalTok{(}\FunctionTok{read.table}\NormalTok{(file)))}
\NormalTok{\}}

\CommentTok{\# Needing to transpose data and rename columns}
\NormalTok{shannon\_entropies }\OtherTok{=} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{t}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(shannon\_entropies)))}
\FunctionTok{colnames}\NormalTok{(shannon\_entropies) }\OtherTok{=}\NormalTok{ column\_names}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Helpful function to calculate standard error of the mean}
\NormalTok{standard\_error }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{sd}\NormalTok{(x) }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{length}\NormalTok{(x))}

\CommentTok{\# Calculate mean entropy and standard error of the mean}
\NormalTok{mean\_entropies }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(shannon\_entropies, mean)}
\NormalTok{se }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(shannon\_entropies, standard\_error)}
\NormalTok{x }\OtherTok{=} \DecValTok{0}\SpecialCharTok{:}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{), }\AttributeTok{fig=}\FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.7}\NormalTok{,}\FloatTok{0.3}\NormalTok{,}\FloatTok{0.9}\NormalTok{))}

\CommentTok{\#For 3\textquotesingle{}UTRÎ”10\_ZIKV :}
\NormalTok{plot1}\OtherTok{\textless{}{-}}\FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(x,mean\_entropies[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{]))}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\NormalTok{plot1,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{x,}\AttributeTok{y=}\NormalTok{V2))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin=}\NormalTok{V2}\SpecialCharTok{{-}}\NormalTok{se[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{],}\AttributeTok{ymax=}\NormalTok{V2}\SpecialCharTok{+}\NormalTok{se[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{]),}\AttributeTok{width=}\NormalTok{.}\DecValTok{1}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"Passages"}\NormalTok{,}\AttributeTok{y=}\StringTok{"Mean Shanon Entropy +/{-} SD"}\NormalTok{,}\AttributeTok{title =}\StringTok{"Mean entropy in 3\textquotesingle{}UTRÎ”10 ZIKV passage 0{-}5"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Mean entropy in 3'UTRÎ”10 ZIKV passage 0-5' in
## 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#For WT\_ZIKV :}
\NormalTok{plot2}\OtherTok{\textless{}{-}}\FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(x,mean\_entropies[}\DecValTok{7}\SpecialCharTok{:}\DecValTok{12}\NormalTok{]))}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\NormalTok{plot2,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{x,}\AttributeTok{y=}\NormalTok{V2))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin=}\NormalTok{V2}\SpecialCharTok{{-}}\NormalTok{se[}\DecValTok{7}\SpecialCharTok{:}\DecValTok{12}\NormalTok{],}\AttributeTok{ymax=}\NormalTok{V2}\SpecialCharTok{+}\NormalTok{se[}\DecValTok{7}\SpecialCharTok{:}\DecValTok{12}\NormalTok{]),}\AttributeTok{width=}\NormalTok{.}\DecValTok{1}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"Passages"}\NormalTok{,}\AttributeTok{y=}\StringTok{"Mean Shanon Entropy +/{-} SD"}\NormalTok{,}\AttributeTok{title =}\StringTok{"Mean entropy in WT ZIKV passage 0{-}5"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-4-2.pdf}

\#\#Shannon Entropy \#\#\#\#\#Mean Shannon Entropy and Mean Coverage

Description of the variables used :

\emph{\textbf{mean\_coverage} : data frame containing for each
passage/strain (columns) the mean coverage observed (rows)
}\textbf{cov\_shannon} : data frame that associates the mean coverage
with the mean entropy for each passage/strain
*\textbf{cov\_ready\_to\_plot} : data frame with an added column which
precise the strain for each couple \{mean\_coverage;mean\_entropy\}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# List the data}
\NormalTok{path\_to\_SNP\_files }\OtherTok{=} \StringTok{"\textasciitilde{}student12/project/results/SNP/"}
\NormalTok{cov\_file\_list }\OtherTok{=} \FunctionTok{list.files}\NormalTok{(path\_to\_SNP\_files, }\AttributeTok{pattern =} \StringTok{"covplot.R"}\NormalTok{ ,}\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Load the data in the folder}
\NormalTok{column\_names }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\NormalTok{mean\_coverage }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (file }\ControlFlowTok{in}\NormalTok{ cov\_file\_list)\{}
\NormalTok{  column\_names }\OtherTok{=} \FunctionTok{cbind}\NormalTok{(column\_names, tools}\SpecialCharTok{::}\FunctionTok{file\_path\_sans\_ext}\NormalTok{(}\FunctionTok{basename}\NormalTok{(file)))}
  \CommentTok{\# Read the file}
  \FunctionTok{source}\NormalTok{(file)}
  \CommentTok{\# variable y is the vector containing the coverage in the file}
\NormalTok{  mean\_coverage }\OtherTok{=} \FunctionTok{rbind}\NormalTok{(mean\_coverage, }\FunctionTok{mean}\NormalTok{(y))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-1.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-2.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-3.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-4.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-5.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-6.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-7.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-8.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-9.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-10.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-11.pdf}
\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-5-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Needing to transpose data and rename columns}
\NormalTok{mean\_coverage }\OtherTok{=} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{t}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(mean\_coverage)))}
\FunctionTok{colnames}\NormalTok{(mean\_coverage) }\OtherTok{=}\NormalTok{ column\_names}

\CommentTok{\# Combine the mean coverage and mean entropies for convenience}
\NormalTok{cov\_shannon }\OtherTok{=} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\FunctionTok{t}\NormalTok{(mean\_coverage), mean\_entropies))}

\CommentTok{\# Replace the rownames with only the strain and passage}
\NormalTok{row\_names }\OtherTok{=} \FunctionTok{str\_replace}\NormalTok{(}\FunctionTok{rownames}\NormalTok{(cov\_shannon), }\StringTok{"SNP\_"}\NormalTok{,}\StringTok{""}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{str\_replace}\NormalTok{(}\StringTok{".covplot"}\NormalTok{,}\StringTok{""}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(cov\_shannon) }\OtherTok{=}\NormalTok{ row\_names}
\FunctionTok{colnames}\NormalTok{(cov\_shannon) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"mean\_coverage"}\NormalTok{,}\StringTok{"mean\_entropies"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#create a new variable that contain either WT or 10}
\NormalTok{strain }\OtherTok{\textless{}{-}}\FunctionTok{substr}\NormalTok{(row\_names,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}

\CommentTok{\#we add those values to the data frame, to identify the samples}
\NormalTok{cov\_ready\_to\_plot }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(cov\_shannon,strain)}

\CommentTok{\#we can now plot the figure}
\FunctionTok{ggplot}\NormalTok{(cov\_ready\_to\_plot, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{mean\_coverage,}\AttributeTok{y=}\NormalTok{mean\_entropies))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{shape=}\NormalTok{strain),}\AttributeTok{size=}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"right"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"Coverage Depth"}\NormalTok{,}\AttributeTok{y=}\StringTok{"Shannon Entropy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor.test}\NormalTok{(cov\_ready\_to\_plot}\SpecialCharTok{$}\NormalTok{mean\_entropies,cov\_ready\_to\_plot}\SpecialCharTok{$}\NormalTok{mean\_coverage, }\AttributeTok{method=}\StringTok{"spearman"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Spearman's rank correlation rho
## 
## data:  cov_ready_to_plot$mean_entropies and cov_ready_to_plot$mean_coverage
## S = 234, p-value = 0.573
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.1818182
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_Shannon }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(mean\_entropies}\SpecialCharTok{\textasciitilde{}}\NormalTok{mean\_coverage, }\AttributeTok{data=}\NormalTok{cov\_ready\_to\_plot)}
\FunctionTok{print}\NormalTok{(model\_Shannon)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mean_entropies ~ mean_coverage, data = cov_ready_to_plot)
## 
## Coefficients:
##   (Intercept)  mean_coverage  
##     7.091e-03      9.702e-08
\end{verbatim}

\hypertarget{snvs}{%
\subsection{SNVs}\label{snvs}}

\#\#\#\#\#SNVs Frequencies per passage per strain

Description of the variables used :

\emph{\textbf{all\_data\_frame\_WT} : List of 6 data frames. Each data
frame contain the position and frequency of all SNVs detected at a given
passage for the WT\_ZIKV. }\textbf{all\_data\_frame\_10D} : List of 6
data frames. Each data frame contain the position and frequency of all
SNVs detected at a given passage for the 10D\_ZIKV.
*\textbf{single\_data\_frame} : a data frame containing each position
and frequency of all SNVs according to their passage and strain

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Processing WT files to remove the two first lines and extract only the information required (position in the genome and frequency of the mutation in the viral population)}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P0.fdr.var.txt }\KeywordTok{|} \FunctionTok{cut}\NormalTok{ {-}f 1,6  }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P0.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P1.fdr.var.txt }\KeywordTok{|} \FunctionTok{cut}\NormalTok{ {-}f 1,6  }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P1.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P2.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,}\OperatorTok{6\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P2.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P3.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,}\OperatorTok{6\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P3.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P4.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,}\OperatorTok{6\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P4.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_WT\_P5.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,}\OperatorTok{6\textgreater{}}\NormalTok{ modified\_SNP\_WT\_P5.fdr.var.txt}
  
  
\CommentTok{\# Processing 10\_D files to remove the two first lines and extract only the information required (position in the genome and frequency of the mutation in the viral population)}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P0.fdr.var.txt }\KeywordTok{|} \FunctionTok{cut}\NormalTok{ {-}f 1,6  }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P0.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P1.fdr.var.txt }\KeywordTok{|} \FunctionTok{cut}\NormalTok{ {-}f 1,6  }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P1.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P2.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,6 }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P2.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P3.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,6 }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P3.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P4.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,6 }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P4.fdr.var.txt}
  \FunctionTok{grep}\NormalTok{ {-}v }\StringTok{"\#"}\NormalTok{ SNP\_10D\_P5.fdr.var.txt }\KeywordTok{|}\FunctionTok{cut}\NormalTok{ {-}f 1,6 }\OperatorTok{\textgreater{}}\NormalTok{ modified\_SNP\_10D\_P5.fdr.var.txt}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## grep: SNP_WT_P0.fdr.var.txt: No such file or directory
## grep: SNP_WT_P1.fdr.var.txt: No such file or directory
## grep: SNP_WT_P2.fdr.var.txt: No such file or directory
## grep: SNP_WT_P3.fdr.var.txt: No such file or directory
## grep: SNP_WT_P4.fdr.var.txt: No such file or directory
## grep: SNP_WT_P5.fdr.var.txt: No such file or directory
## grep: SNP_10D_P0.fdr.var.txt: No such file or directory
## grep: SNP_10D_P1.fdr.var.txt: No such file or directory
## grep: SNP_10D_P2.fdr.var.txt: No such file or directory
## grep: SNP_10D_P3.fdr.var.txt: No such file or directory
## grep: SNP_10D_P4.fdr.var.txt: No such file or directory
## grep: SNP_10D_P5.fdr.var.txt: No such file or directory
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Creation of a data frame containing all the SNVs for each passage for each strain by listing the files of interest using list.files.}

\NormalTok{path\_to\_SNP\_files }\OtherTok{=}\StringTok{"/home/student12/project/results/SNP"}
\NormalTok{all\_files\_WT }\OtherTok{=} \FunctionTok{list.files}\NormalTok{(path\_to\_SNP\_files, }\AttributeTok{pattern =}\StringTok{"modified\_SNP\_WT"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{all\_files\_10D }\OtherTok{=} \FunctionTok{list.files}\NormalTok{(path\_to\_SNP\_files, }\AttributeTok{pattern =}\StringTok{"modified\_SNP\_10D"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\#Importation of every files per strain under the data frame format :}

\NormalTok{all\_data\_frames\_WT }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(all\_files\_WT, }\ControlFlowTok{function}\NormalTok{(x)\{}
  \FunctionTok{read.csv}\NormalTok{(x,}\AttributeTok{header =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{sep=}\StringTok{"}\SpecialCharTok{\textbackslash{}t}\StringTok{"}\NormalTok{) \} )}
\NormalTok{all\_data\_frames\_10D }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(all\_files\_10D, }\ControlFlowTok{function}\NormalTok{(x)\{}
  \FunctionTok{read.csv}\NormalTok{(x,}\AttributeTok{header =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{sep=}\StringTok{"}\SpecialCharTok{\textbackslash{}t}\StringTok{"}\NormalTok{) \} )}

\CommentTok{\#Modification of the name of the columns to identify positions and frequencies.}
\CommentTok{\#Creation of a new column containing the number of the passage for each SNV.}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{) \{}
  \FunctionTok{colnames}\NormalTok{(all\_data\_frames\_WT[[i]]) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Position"}\NormalTok{,}\StringTok{"Frequency"}\NormalTok{)}
\NormalTok{  all\_data\_frames\_WT[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(all\_data\_frames\_WT[[i]], }\AttributeTok{Passage =}\NormalTok{ i}\DecValTok{{-}1}\NormalTok{)}
\NormalTok{  all\_data\_frames\_WT[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(all\_data\_frames\_WT[[i]],}\AttributeTok{Strain =} \StringTok{"WT"}\NormalTok{)}
\NormalTok{\}}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{) \{}
  \FunctionTok{colnames}\NormalTok{(all\_data\_frames\_10D[[i]]) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Position"}\NormalTok{,}\StringTok{"Frequency"}\NormalTok{)}
\NormalTok{  all\_data\_frames\_10D[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(all\_data\_frames\_10D[[i]], }\AttributeTok{Passage =}\NormalTok{ i}\DecValTok{{-}1}\NormalTok{)}
\NormalTok{  all\_data\_frames\_10D[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(all\_data\_frames\_10D[[i]],}\AttributeTok{Strain =} \StringTok{"10D"}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\#The data frames are bind together to simplify data manipulation :}
\NormalTok{single\_data\_frame }\OtherTok{\textless{}{-}} \FunctionTok{Reduce}\NormalTok{(rbind, }\FunctionTok{c}\NormalTok{(all\_data\_frames\_WT,all\_data\_frames\_10D))}
\NormalTok{single\_data\_frame}\SpecialCharTok{$}\NormalTok{Passage }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(single\_data\_frame}\SpecialCharTok{$}\NormalTok{Passage)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{), }\AttributeTok{fig=}\FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.7}\NormalTok{,}\FloatTok{0.3}\NormalTok{,}\FloatTok{0.9}\NormalTok{)) }

\CommentTok{\#For the WT\_ZIKV :}
\NormalTok{single\_data\_frame }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Strain }\SpecialCharTok{==}\StringTok{"WT"}\NormalTok{)}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Passage, }\AttributeTok{y=}\NormalTok{ Frequency)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \StringTok{"jitter"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Passage"}\NormalTok{, }\AttributeTok{y =} \StringTok{"SNV Frequency (\%)"}\NormalTok{, }\AttributeTok{title =} \StringTok{"WT"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#For the 10D\_ZIKV :}
\NormalTok{single\_data\_frame }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Strain }\SpecialCharTok{==}\StringTok{"10D"}\NormalTok{)}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Passage, }\AttributeTok{y=}\NormalTok{ Frequency)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \StringTok{"jitter"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Passage"}\NormalTok{, }\AttributeTok{y =} \StringTok{"SNV Frequency (\%)"}\NormalTok{, }\AttributeTok{title =}\StringTok{"3\textquotesingle{}UTRÎ”10"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on '3'UTRÎ”10' in 'mbcsToSbcs': dot substituted for <94>
\end{verbatim}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-10-2.pdf}

\#\#\#\#\#Mapping Mutations in the Genome

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#The single\_data\_frame containing all the information required is filtered, and arranged according the position of the SNV in the genome. The repetitions of SNVs are removed with the command distinct.}

\NormalTok{mutation\_of\_interest }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(single\_data\_frame, Frequency }\SpecialCharTok{\textgreater{}=} \DecValTok{5}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Position)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{(Position, }\AttributeTok{.keep\_all =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(Strain)}

\FunctionTok{ggplot}\NormalTok{(mutation\_of\_interest, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Position, }\AttributeTok{y =}\NormalTok{ Strain, }\AttributeTok{color=}\NormalTok{Strain,}\AttributeTok{label=}\NormalTok{Passage))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{108}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{473}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{474}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{977}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{978}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{2489}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{2490}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{3545}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{3546}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{4223}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{4224}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{4613}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{4614}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{6464}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{6465}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{6914}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{6915}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{7667}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \DecValTok{7668}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{10379}\NormalTok{ ,}\AttributeTok{ymin =}\DecValTok{0}\NormalTok{,}\AttributeTok{ymax=} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{150}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.7}\NormalTok{, }\AttributeTok{label =} \StringTok{"C"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{725}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.5}\NormalTok{, }\AttributeTok{label =} \StringTok{"prM/M"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{1500}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.7}\NormalTok{, }\AttributeTok{label =} \StringTok{"E"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{3017}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.5}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS1"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{3884}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.7}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS2A"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{4418}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.5}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS2B"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{5539}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.7}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS3"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{6689}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.5}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS4A"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{7291}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.7}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS4B"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{9023}\NormalTok{, }\AttributeTok{y =} \FloatTok{2.5}\NormalTok{, }\AttributeTok{label =} \StringTok{"NS5"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-11-1.pdf}

\#\#\#\#\#Mean Coverage and Total ammount of SNV

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#The total ammount of SNV per passage per strain is calculated from the single\_data\_frame. The mean\_coverage and the total\_ammount\_SNV are associated in a data frame (SNV\_ammount\_and\_coverage) and plotted.}


\NormalTok{total\_ammount\_SNV }\OtherTok{=} \FunctionTok{count}\NormalTok{(single\_data\_frame,Passage,Strain)}
\NormalTok{total\_ammount\_SNV }\OtherTok{=} \FunctionTok{arrange}\NormalTok{(total\_ammount\_SNV,Strain)}
\NormalTok{SNV\_ammount\_and\_coverage }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(total\_ammount\_SNV,}\FunctionTok{t}\NormalTok{(mean\_coverage))}
\FunctionTok{colnames}\NormalTok{(SNV\_ammount\_and\_coverage) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Passage"}\NormalTok{,}\StringTok{"Strain"}\NormalTok{,}\StringTok{"n"}\NormalTok{,}\StringTok{"mean\_coverage"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(SNV\_ammount\_and\_coverage, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{mean\_coverage,}\AttributeTok{y=}\NormalTok{n))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{shape=}\NormalTok{strain), }\AttributeTok{size =}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"right"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_prism}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"Coverage Depth"}\NormalTok{,}\AttributeTok{y=}\StringTok{"Total of SNVs"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\includegraphics{result_visualization_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor.test}\NormalTok{(SNV\_ammount\_and\_coverage}\SpecialCharTok{$}\NormalTok{n,SNV\_ammount\_and\_coverage}\SpecialCharTok{$}\NormalTok{mean\_coverage,}\AttributeTok{method=}\StringTok{"spearman"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Spearman's rank correlation rho
## 
## data:  SNV_ammount_and_coverage$n and SNV_ammount_and_coverage$mean_coverage
## S = 132, p-value = 0.0749
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.5384615
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_SNV }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(n }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mean\_coverage, }\AttributeTok{data=}\NormalTok{SNV\_ammount\_and\_coverage)}
\FunctionTok{print}\NormalTok{(model\_SNV)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = n ~ mean_coverage, data = SNV_ammount_and_coverage)
## 
## Coefficients:
##   (Intercept)  mean_coverage  
##     33.657672       0.006532
\end{verbatim}

\end{document}
